<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Production Planning Model - Historical Data Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .main-content {
            padding: 30px;
        }

        .control-panel {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .control-group {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
        }

        .control-group h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .calculate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.3s;
            display: block;
            margin: 30px auto;
        }

        .calculate-btn:hover {
            transform: scale(1.05);
        }

        .results-section {
            display: none;
        }

        .results-section.active {
            display: block;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .result-card h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .result-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }

        .result-change {
            font-size: 1.2em;
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
        }

        .result-change.positive {
            background: #4caf50;
            color: white;
        }

        .result-change.negative {
            background: #f44336;
            color: white;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .week-table {
            width: 100%;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .week-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .week-table th, .week-table td {
            padding: 15px;
            text-align: center;
        }

        .week-table tbody tr:nth-child(even) {
            background: #f8f9fa;
        }

        .week-table tbody tr:hover {
            background: #e8eaf6;
        }

        .impact-badge {
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: bold;
            display: inline-block;
        }

        .impact-badge.weather {
            background: #2196f3;
            color: white;
        }

        .impact-badge.holiday {
            background: #ff9800;
            color: white;
        }

        .impact-badge.stockout {
            background: #f44336;
            color: white;
        }

        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ AI Production Planning Model</h1>
            <p>Intelligent forecasting based on historical data, weather patterns, holidays, and inventory events</p>
        </div>

        <div class="main-content">
            <div class="control-panel">
                <h2 style="color: #333; margin-bottom: 20px;">üìä Planning Parameters</h2>

                <div class="control-grid">
                    <div class="control-group">
                        <h3>üìÖ Time Period</h3>
                        <div class="input-group">
                            <label>Select Week to Plan</label>
                            <select id="weekSelect">
                                <option value="current">Current Week (This Year)</option>
                                <option value="next">Next Week</option>
                                <option value="custom">Custom Week</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Product Category</label>
                            <select id="productCategory">
                                <option value="beverages">Beverages</option>
                                <option value="snacks">Snacks</option>
                                <option value="dairy">Dairy Products</option>
                                <option value="bakery">Bakery Items</option>
                            </select>
                        </div>
                    </div>

                    <div class="control-group">
                        <h3>üìà Historical Data (Last Year)</h3>
                        <div class="input-group">
                            <label>Base Sales (units/day)</label>
                            <input type="number" id="baseSales" value="1000" min="0">
                        </div>
                        <div class="input-group">
                            <label>Had Stockout?</label>
                            <select id="hadStockout">
                                <option value="no">No</option>
                                <option value="yes">Yes - Lost Sales</option>
                            </select>
                        </div>
                        <div class="input-group" id="stockoutDaysGroup" style="display: none;">
                            <label>Stockout Days</label>
                            <input type="number" id="stockoutDays" value="2" min="1" max="7">
                        </div>
                    </div>

                    <div class="control-group">
                        <h3>üå§Ô∏è Weather Impact</h3>
                        <div class="input-group">
                            <label>This Year's Weather</label>
                            <select id="weatherCondition">
                                <option value="normal">Normal</option>
                                <option value="hot">Hot/Sunny (+15% sales)</option>
                                <option value="cold">Cold/Rainy (-10% sales)</option>
                                <option value="extreme">Extreme Weather (-25% sales)</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Last Year's Weather</label>
                            <select id="lastYearWeather">
                                <option value="normal">Normal</option>
                                <option value="hot">Hot/Sunny</option>
                                <option value="cold">Cold/Rainy</option>
                                <option value="extreme">Extreme Weather</option>
                            </select>
                        </div>
                    </div>

                    <div class="control-group">
                        <h3>üéâ Holiday Impact</h3>
                        <div class="input-group">
                            <label>Upcoming Holiday</label>
                            <select id="holidayType">
                                <option value="none">No Holiday</option>
                                <option value="minor">Minor Holiday (+10%)</option>
                                <option value="major">Major Holiday (+30%)</option>
                                <option value="christmas">Christmas/New Year (+50%)</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Days Before Holiday</label>
                            <input type="number" id="daysBeforeHoliday" value="7" min="1" max="30">
                        </div>
                    </div>
                </div>

                <button class="calculate-btn" onclick="calculatePlan()">
                    üöÄ Generate AI Planning Forecast
                </button>
            </div>

            <div class="results-section" id="results">
                <h2 style="color: #333; margin-bottom: 20px;">üìä AI-Powered Forecast Results</h2>

                <div class="results-grid">
                    <div class="result-card">
                        <h4>Last Year Sales</h4>
                        <div class="result-value" id="lastYearTotal">0</div>
                        <div>units/week</div>
                    </div>
                    <div class="result-card">
                        <h4>Adjusted Forecast</h4>
                        <div class="result-value" id="forecastTotal">0</div>
                        <div>units/week</div>
                        <div class="result-change" id="changePercent">0%</div>
                    </div>
                    <div class="result-card">
                        <h4>Recommended Production</h4>
                        <div class="result-value" id="productionTotal">0</div>
                        <div>units/week</div>
                    </div>
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #4caf50;"></div>
                        <span>Last Year (Actual)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #2196f3;"></div>
                        <span>This Year (Forecast)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ff9800;"></div>
                        <span>Production Plan</span>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="comparisonChart"></canvas>
                </div>

                <h3 style="color: #333; margin: 20px 0;">üìÖ Daily Breakdown</h3>
                <table class="week-table">
                    <thead>
                        <tr>
                            <th>Day</th>
                            <th>Last Year</th>
                            <th>Base Forecast</th>
                            <th>Adjustments</th>
                            <th>Final Forecast</th>
                            <th>Production Plan</th>
                        </tr>
                    </thead>
                    <tbody id="weekTableBody">
                    </tbody>
                </table>

                <div class="chart-container" style="margin-top: 30px;">
                    <h3 style="color: #333; margin-bottom: 15px;">üìà Impact Analysis</h3>
                    <canvas id="impactChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        let comparisonChart = null;
        let impactChart = null;

        // Show/hide stockout days based on selection
        document.getElementById('hadStockout').addEventListener('change', function() {
            const stockoutGroup = document.getElementById('stockoutDaysGroup');
            stockoutGroup.style.display = this.value === 'yes' ? 'block' : 'none';
        });

        function calculatePlan() {
            // Get input values
            const baseSales = parseFloat(document.getElementById('baseSales').value);
            const hadStockout = document.getElementById('hadStockout').value === 'yes';
            const stockoutDays = hadStockout ? parseInt(document.getElementById('stockoutDays').value) : 0;
            const weatherCondition = document.getElementById('weatherCondition').value;
            const lastYearWeather = document.getElementById('lastYearWeather').value;
            const holidayType = document.getElementById('holidayType').value;
            const daysBeforeHoliday = parseInt(document.getElementById('daysBeforeHoliday').value);
            const productCategory = document.getElementById('productCategory').value;

            // Weather impact factors
            const weatherImpacts = {
                'normal': 1.0,
                'hot': 1.15,
                'cold': 0.9,
                'extreme': 0.75
            };

            // Holiday impact factors
            const holidayImpacts = {
                'none': 1.0,
                'minor': 1.1,
                'major': 1.3,
                'christmas': 1.5
            };

            // Calculate last year's actual (with weather adjustment)
            const lastYearWeatherFactor = weatherImpacts[lastYearWeather];
            const lastYearDailySales = baseSales * lastYearWeatherFactor;

            // Days of the week with typical patterns
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
            const dayPatterns = {
                'Monday': 0.85,
                'Tuesday': 0.9,
                'Wednesday': 0.95,
                'Thursday': 1.0,
                'Friday': 1.2,
                'Saturday': 1.3,
                'Sunday': 1.1
            };

            // Calculate daily data
            const weekData = [];
            let lastYearTotal = 0;
            let forecastTotal = 0;
            let productionTotal = 0;

            days.forEach((day, index) => {
                // Last year's sales (accounting for stockout)
                let lastYearSales = lastYearDailySales * dayPatterns[day];
                if (hadStockout && index >= (7 - stockoutDays)) {
                    lastYearSales = 0; // Lost sales due to stockout
                }
                lastYearTotal += lastYearSales;

                // Base forecast (correcting for last year's stockout if applicable)
                let baseForecast = baseSales * dayPatterns[day];
                if (hadStockout && index >= (7 - stockoutDays)) {
                    // Estimate what would have been sold
                    baseForecast *= 1.2; // 20% increase for pent-up demand
                }

                // Apply weather difference adjustment
                const weatherAdjustment = weatherImpacts[weatherCondition] / weatherImpacts[lastYearWeather];
                let forecast = baseForecast * weatherAdjustment;

                // Apply holiday impact (stronger as we get closer to holiday)
                let proximityFactor = 0;
                if (holidayType !== 'none') {
                    proximityFactor = Math.max(0, 1 - (daysBeforeHoliday - (7 - index)) / daysBeforeHoliday);
                    const holidayBoost = 1 + (holidayImpacts[holidayType] - 1) * proximityFactor;
                    forecast *= holidayBoost;
                }

                // Production plan (add safety buffer)
                const production = Math.ceil(forecast * 1.1); // 10% safety buffer

                forecastTotal += forecast;
                productionTotal += production;

                weekData.push({
                    day: day,
                    lastYear: Math.round(lastYearSales),
                    baseForecast: Math.round(baseForecast),
                    forecast: Math.round(forecast),
                    production: production,
                    impacts: {
                        weather: weatherAdjustment !== 1,
                        holiday: holidayType !== 'none' && proximityFactor > 0,
                        stockout: hadStockout && index >= (7 - stockoutDays)
                    }
                });
            });

            // Update result cards
            document.getElementById('lastYearTotal').textContent = Math.round(lastYearTotal).toLocaleString();
            document.getElementById('forecastTotal').textContent = Math.round(forecastTotal).toLocaleString();
            document.getElementById('productionTotal').textContent = Math.round(productionTotal).toLocaleString();

            // Calculate change percentage
            const changePercent = ((forecastTotal - lastYearTotal) / lastYearTotal * 100).toFixed(1);
            const changeElement = document.getElementById('changePercent');
            changeElement.textContent = (changePercent > 0 ? '+' : '') + changePercent + '%';
            changeElement.className = 'result-change ' + (changePercent > 0 ? 'positive' : 'negative');

            // Update week table
            const tableBody = document.getElementById('weekTableBody');
            tableBody.innerHTML = '';

            weekData.forEach(dayData => {
                const row = document.createElement('tr');

                // Build adjustments cell
                let adjustments = [];
                if (dayData.impacts.weather) adjustments.push('<span class="impact-badge weather">Weather</span>');
                if (dayData.impacts.holiday) adjustments.push('<span class="impact-badge holiday">Holiday</span>');
                if (dayData.impacts.stockout) adjustments.push('<span class="impact-badge stockout">Stockout</span>');

                row.innerHTML = `
                    <td><strong>${dayData.day}</strong></td>
                    <td>${dayData.lastYear.toLocaleString()}</td>
                    <td>${dayData.baseForecast.toLocaleString()}</td>
                    <td>${adjustments.join(' ') || '-'}</td>
                    <td><strong>${dayData.forecast.toLocaleString()}</strong></td>
                    <td style="background: #fff3e0;"><strong>${dayData.production.toLocaleString()}</strong></td>
                `;
                tableBody.appendChild(row);
            });

            // Update comparison chart
            if (comparisonChart) {
                comparisonChart.destroy();
            }

            const ctx1 = document.getElementById('comparisonChart').getContext('2d');
            comparisonChart = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'Last Year (Actual)',
                        data: weekData.map(d => d.lastYear),
                        borderColor: '#4caf50',
                        backgroundColor: 'rgba(76, 175, 80, 0.1)',
                        borderWidth: 3,
                        tension: 0.4
                    }, {
                        label: 'This Year (Forecast)',
                        data: weekData.map(d => d.forecast),
                        borderColor: '#2196f3',
                        backgroundColor: 'rgba(33, 150, 243, 0.1)',
                        borderWidth: 3,
                        tension: 0.4
                    }, {
                        label: 'Production Plan',
                        data: weekData.map(d => d.production),
                        borderColor: '#ff9800',
                        backgroundColor: 'rgba(255, 152, 0, 0.1)',
                        borderWidth: 3,
                        borderDash: [5, 5],
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Week Comparison: Last Year vs. Forecast vs. Production',
                            font: {
                                size: 16
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Units'
                            }
                        }
                    }
                }
            });

            // Calculate impact breakdown
            const baseTotal = baseSales * 7;
            const weatherImpact = (weatherImpacts[weatherCondition] - weatherImpacts[lastYearWeather]) * baseTotal;
            const holidayImpact = holidayType !== 'none' ? (holidayImpacts[holidayType] - 1) * baseTotal * 0.5 : 0;
            const stockoutCorrection = hadStockout ? stockoutDays * baseSales * 0.2 : 0;

            // Update impact chart
            if (impactChart) {
                impactChart.destroy();
            }

            const ctx2 = document.getElementById('impactChart').getContext('2d');
            impactChart = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: ['Base Demand', 'Weather Impact', 'Holiday Impact', 'Stockout Correction', 'Safety Buffer'],
                    datasets: [{
                        label: 'Units',
                        data: [
                            baseTotal,
                            Math.abs(weatherImpact),
                            holidayImpact,
                            stockoutCorrection,
                            forecastTotal * 0.1
                        ],
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            weatherImpact > 0 ? 'rgba(76, 175, 80, 0.8)' : 'rgba(244, 67, 54, 0.8)',
                            'rgba(255, 152, 0, 0.8)',
                            'rgba(156, 39, 176, 0.8)',
                            'rgba(96, 125, 139, 0.8)'
                        ],
                        borderColor: [
                            'rgba(102, 126, 234, 1)',
                            weatherImpact > 0 ? 'rgba(76, 175, 80, 1)' : 'rgba(244, 67, 54, 1)',
                            'rgba(255, 152, 0, 1)',
                            'rgba(156, 39, 176, 1)',
                            'rgba(96, 125, 139, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Forecast Impact Breakdown',
                            font: {
                                size: 16
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Units'
                            }
                        }
                    }
                }
            });

            // Show results section
            document.getElementById('results').classList.add('active');

            // Smooth scroll to results
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        // Initialize with sample data on load
        window.addEventListener('load', function() {
            // Set some interesting default values
            document.getElementById('baseSales').value = '1500';
            document.getElementById('weatherCondition').value = 'hot';
            document.getElementById('holidayType').value = 'major';
            document.getElementById('hadStockout').value = 'yes';
            document.getElementById('stockoutDaysGroup').style.display = 'block';
        });
    </script>
</body>
</html>